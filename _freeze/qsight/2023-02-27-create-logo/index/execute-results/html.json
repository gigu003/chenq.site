{
  "hash": "525bc5c5bb76394c84583645b45e8dd5",
  "result": {
    "markdown": "---\ntitle: 开发R包一定要有一个高逼格logo\nsubtitle: 利用hexSticker包快速制作R包logo\ndate: \"2023-02-27\"\nslug: create-r-logo\ncategories: [个人网站]\nkeywords: [R语言, logo, R包]\ntoc: true\nimage: \"00005b.png\"\n---\n\n\n![canregtools](canregtools.png)\n\n自从我参加工作以来，一直使用SAS统计软件协助分析肿瘤登记数据。在这段时间内，我积累了大量的SAS宏和程序，对我的工作产生了很大的帮助。比如说，肿瘤数据的逻辑核查功能、报告数据生成功能、制作肿瘤登记年报等，这些程序在很大程度上提高了工作效率。但是，与R语言或Stata软件不同，SAS公司没有以包的形式分享相关的函数或功能，这也带来了很多不便。跟同事分享SAS分享程序时，可能因为系统环境或者其他因素的不同，造成程序不能执行。R包的制作有严格的流程和要求，能够很大程度上避免这种情况的发生。\n\n今年年初定下的目标就是利用休息时间把这个包付出实践，最近这几天制作了其中的一个函数classify_icd10()，以后有时间再逐步完善相关的功能。虽然现在只有这一个函数，但是麻雀虽小五脏俱全。包的名字从cnCanreg到PBCRtools，再到canregtools，已经换了三次了，最终采用canregtools。[canregtools](https://github.com/gigu003/canregtools)的代码托管到了[github](https://github.com/gigu003)上，以方便代码管理。制作了[canregtools网站](https://gigu003.github.io/canregtools/)，方便使用者查找并使用相关功能。\n\n为了提高逼格，还制作了canregtools的logo，把一个癌细胞的图片和河南省癌症的年龄别发病率曲线整合到一块，最后制作成了六角的logo。\n\n下面跟大家分享一下制作这个logo的代码。\n\n##  制作癌症年龄别发病率折线图\n\n首先，读入年龄别发病率的数据，然后，利用ggplot2制作折线图，重点是要把图片背景设置成透明。\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-1_9454e57cca1ceb957ab87765cd83d965'}\n\n```{.r .cell-code}\n# 加载tidyverse包 \nlibrary(tidyverse)\n# 读取年龄别发病率数据\ndata <- read.csv(\"data.csv\")\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   sex agegrp incidence\n1 Male      0     15.06\n2 Male      1     11.78\n3 Male      5     11.51\n4 Male     10     11.56\n5 Male     15     14.92\n6 Male     20     15.37\n```\n:::\n\n```{.r .cell-code}\n#绘制癌症年龄别发病率折线图\npic <-\n  data %>% \n  ggplot(aes(x=agegrp,y=incidence,color=sex))+\n  geom_line(size=1) +\n  ylab(\"Cancer Incidence\")+\n  xlab(\"Age groups (years)\")+\n  theme_void()+\n  theme(legend.position = \"none\",\n        plot.background = element_blank()\n        )\n\nplot(pic)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\n## 把肿瘤细胞图片读入R中\n\n我从google上搜索了一张癌细胞的图片，并利用在线工具把这张图片的背景去除。然后，利用magick包读取图片进入R环境中，转化成ggplot2可识别的元素，最后，以注释的方式加入前面生成折线图中。\n\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_8eaee272b9a64f894301ba17b8bd94ad'}\n\n```{.r .cell-code}\nlibrary(magick)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to ImageMagick 6.9.12.3\nEnabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n```\n:::\n\n```{.r .cell-code}\n# 读取肿瘤细胞的图片\npcs <- image_read(\"cancer-cell.png\")\nimage <- image_fill(pcs,\"none\")\nraster <- as.raster(image)\n\n# 把肿瘤细胞的图片添加到ggplot2绘制的折线图上\nmyplot <- pic +\n  annotation_raster(raster = raster, 0, 30, 100, 700)\nmyplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## 制作六角R包logo\n\n最后利用hexSticker包制作logo，具体语句如下。\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_71850207cd9a7c9feb9b6daad3e2ec3a'}\n\n```{.r .cell-code}\nlibrary(hexSticker)\n\nsticker(\n  subplot = myplot,\n  package = \"canregtools\",\n  s_width = 1,\n  s_height = .8,\n  s_x = 1,\n  s_y = .75,\n  p_size = 14,\n  p_color = \"purple\",\n  p_fontface = \"bold\",\n # p_family = \"Apple Braille\",\n  h_fill = \"gold\",\n  h_color = \"hotpink\",\n  h_size = 1.5,\n  url = \"canregtools.chenq.site/canregtools\",\n  u_size = 3,\n  u_color = \"violetred\",\n  spotlight = T,\n  l_y = 1,\n  l_x = 1,\n  l_width = 3,\n  l_height = 3,\n  l_alpha = .3\n) %>% print()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n效果怎么样？对于审美感不足的我来说，还算可以吧！\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}